var marked = require('marked');

marked.setOptions({
	gfm: true,
	tables: true
});

module.exports = function (compendium, app) {

	return function (req, res, next) {

		req.page = compendium.get(req.route.params[0]);

		req.page.html = marked(req.page.markdown);

		next();

	};

}