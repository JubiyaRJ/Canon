'use strict';

var path = require('path'),
	express = require('express'),
	routes = require('../routes');

function server (port, catalog, navigation) {

	// create class variables
	var app = this.app = express();

	// all environments
	app.set('port', port);
	app.set('views', path.resolve(__dirname, '..', 'views'));
	app.set('view engine', 'jade');
	app.use(express.favicon());
	app.use(express.logger('dev'));
	app.use(express.bodyParser());
	app.use(express.methodOverride());
	app.use(express.static(path.resolve(__dirname, '..', 'public')));

	app.locals({
		catalog: catalog || {},
		navigation: navigation || '<ul></ul>'
	});

	// development only
	if ('development' == app.get('env')) {
		app.use(express.errorHandler());
	}

	app.get('/', routes.home);

	return this;

}

exports.server = server;
exports.express = express